appId: com.kangfenmao.CherryStudio
productName: Cherry Studio
electronLanguages:
  - zh-CN
  - zh-TW
  - en-US
  - ja # macOS/linux/win
  - ru # macOS/linux/win
  - zh_CN # for macOS
  - zh_TW # for macOS
  - en # for macOS
  - de
directories:
  buildResources: build

protocols:
  - name: Cherry Studio
    schemes:
      - cherrystudio
files:
  - "**/*"
  - "!**/{.vscode,.yarn,.yarn-lock,.github,.cursorrules,.prettierrc}"
  - "!electron.vite.config.{js,ts,mjs,cjs}}"
  - "!.*"
  - "!components.json"
  - "!**/{.eslintignore,.eslintrc.js,.eslintrc.json,.eslintcache,root.eslint.config.js,eslint.config.js,.eslintrc.cjs,.prettierignore,.prettierrc.yaml,eslint.config.mjs,dev-app-update.yml,CHANGELOG.md,README.md,biome.jsonc}"
  - "!**/{.env,.env.*,.npmrc,pnpm-lock.yaml}"
  - "!**/{tsconfig.json,tsconfig.tsbuildinfo,tsconfig.node.json,tsconfig.web.json}"
  - "!**/{.editorconfig,.jekyll-metadata}"
  - "!src"
  - "!scripts"
  - "!local"
  - "!docs"
  - "!packages"
  - "!.swc"
  - "!.bin"
  - "!._*"
  - "!*.log"
  - "!stats.html"
  - "!*.md"
  - "!**/*.{iml,o,hprof,orig,pyc,pyo,rbc,swp,csproj,sln,xproj}"
  - "!**/*.{map,ts,tsx,jsx,less,scss,sass,css.d.ts,d.cts,d.mts,md,markdown,yaml,yml}"
  - "!**/{test,tests,__tests__,powered-test,coverage}/**"
  - "!**/{example,examples}/**"
  - "!**/*.{spec,test}.{js,jsx,ts,tsx}"
  - "!**/*.min.*.map"
  - "!**/*.d.ts"
  - "!**/dist/es6/**"
  - "!**/dist/demo/**"
  - "!**/amd/**"
  - "!**/{.DS_Store,Thumbs.db,thumbs.db,__pycache__}"
  - "!**/{LICENSE,license,LICENSE.*,*.LICENSE.txt,NOTICE.txt,README.md,readme.md,CHANGELOG.md}"
  - "!node_modules/rollup-plugin-visualizer"
  - "!node_modules/js-tiktoken"
  - "!node_modules/@tavily/core/node_modules/js-tiktoken"
  - "!node_modules/pdf-parse/lib/pdf.js/{v1.9.426,v1.10.88,v2.0.550}"
  - "!node_modules/mammoth/{mammoth.browser.js,mammoth.browser.min.js}"
  - "!node_modules/selection-hook/prebuilds/**/*" # we rebuild .node, don't use prebuilds
  - "!node_modules/selection-hook/node_modules" # we don't need what in the node_modules dir
  - "!node_modules/selection-hook/src" # we don't need source files
  - "!node_modules/tesseract.js-core/{tesseract-core.js,tesseract-core.wasm,tesseract-core.wasm.js}" # we don't need source files
  - "!node_modules/tesseract.js-core/{tesseract-core-lstm.js,tesseract-core-lstm.wasm,tesseract-core-lstm.wasm.js}" # we don't need source files
  - "!node_modules/tesseract.js-core/{tesseract-core-simd-lstm.js,tesseract-core-simd-lstm.wasm,tesseract-core-simd-lstm.wasm.js}" # we don't need source files
  - "!**/*.{h,iobj,ipdb,tlog,recipe,vcxproj,vcxproj.filters,Makefile,*.Makefile}" # filter .node build files
asarUnpack:
  - resources/**
  - "**/*.{metal,exp,lib}"
  - "node_modules/@img/sharp-libvips-*/**"

# copy from node_modules/claude-code-plugins/plugins to resources/data/claude-code-pluginso
extraResources:
  - from: "./node_modules/claude-code-plugins/plugins/"
    to: "claude-code-plugins"

win:
  executableName: Cherry Studio
  artifactName: ${productName}-${version}-${arch}-setup.${ext}
  target:
    - target: nsis
    - target: portable
  signtoolOptions:
    sign: scripts/win-sign.js
  verifyUpdateCodeSignature: false
nsis:
  artifactName: ${productName}-${version}-${arch}-setup.${ext}
  shortcutName: ${productName}
  uninstallDisplayName: ${productName}
  createDesktopShortcut: always
  allowToChangeInstallationDirectory: true
  oneClick: false
  include: build/nsis-installer.nsh
  buildUniversalInstaller: false
portable:
  artifactName: ${productName}-${version}-${arch}-portable.${ext}
  buildUniversalInstaller: false
mac:
  entitlementsInherit: build/entitlements.mac.plist
  notarize: false
  artifactName: ${productName}-${version}-${arch}.${ext}
  extendInfo:
    - NSCameraUsageDescription: Application requests access to the device's camera.
    - NSMicrophoneUsageDescription: Application requests access to the device's microphone.
    - NSDocumentsFolderUsageDescription: Application requests access to the user's Documents folder.
    - NSDownloadsFolderUsageDescription: Application requests access to the user's Downloads folder.
  target:
    - target: dmg
    - target: zip
linux:
  artifactName: ${productName}-${version}-${arch}.${ext}
  target:
    - target: AppImage
    - target: deb
    - target: rpm
  maintainer: electronjs.org
  category: Utility
  desktop:
    entry:
      StartupWMClass: CherryStudio
  mimeTypes:
    - x-scheme-handler/cherrystudio
rpm:
  # Workaround for electron build issue on rpm package:
  # https://github.com/electron/forge/issues/3594
  fpm: ["--rpm-rpmbuild-define=_build_id_links none"]
publish:
  provider: generic
  url: https://releases.cherry-ai.com
electronDownload:
  mirror: https://npmmirror.com/mirrors/electron/
beforePack: scripts/before-pack.js
afterPack: scripts/after-pack.js
afterSign: scripts/notarize.js
artifactBuildCompleted: scripts/artifact-build-completed.js
releaseInfo:
  releaseNotes: |
    <!--LANG:en-->
    Cherry Studio 1.7.7 - New Models & UI Improvements

    This release adds new AI model support, OpenRouter integration, and UI redesigns.

    âœ¨ New Features
    - [Models] Add GLM-4.7 and MiniMax-M2.1 model support
    - [Provider] Add OpenRouter provider support
    - [OVMS] Upgrade to 2025.4 with Qwen3-4B-int4-ov preset model
    - [OVMS] Close OVMS process when app quits
    - [Search] Show keyword-adjacent snippets in history search
    - [Painting] Add extend_params support for DMX painting
    - [UI] Add MCP logo and replace Hammer icon

    ğŸ¨ UI Improvements
    - [Notes] Move notes settings to popup in NotesPage for quick access
    - [WebSearch] Redesign settings with two-column layout and "Set as Default" button
    - [Display] Improve font selector for long font names
    - [Transfer] Rename LanDrop to LanTransfer

    ğŸ› Bug Fixes
    - [API] Correct aihubmix Anthropic API path
    - [OpenRouter] Support GPT-5.1/5.2 reasoning effort 'none' and improve error handling
    - [Thinking] Fix interleaved thinking support
    - [Memory] Fix retrieval issues and enable database backup
    - [Settings] Update default assistant settings to disable temperature
    - [OpenAI] Add persistent server configuration support
    - [Azure] Normalize Azure endpoint
    - [MCP] Check system npx/uvx before falling back to bundled binaries
    - [Prompt] Improve language instruction clarity
    - [Models] Include GPT5.2 series in verbosity check
    - [URL] Enhance urlContext validation for supported providers and models

    <!--LANG:zh-CN-->
    Cherry Studio 1.7.7 - æ–°æ¨¡å‹ä¸ç•Œé¢æ”¹è¿›

    æœ¬æ¬¡æ›´æ–°æ·»åŠ äº†æ–° AI æ¨¡å‹æ”¯æŒã€OpenRouter é›†æˆä»¥åŠç•Œé¢é‡æ–°è®¾è®¡ã€‚

    âœ¨ æ–°åŠŸèƒ½
    - [æ¨¡å‹] æ·»åŠ  GLM-4.7 å’Œ MiniMax-M2.1 æ¨¡å‹æ”¯æŒ
    - [æœåŠ¡å•†] æ·»åŠ  OpenRouter æœåŠ¡å•†æ”¯æŒ
    - [OVMS] å‡çº§è‡³ 2025.4ï¼Œæ–°å¢ Qwen3-4B-int4-ov é¢„è®¾æ¨¡å‹
    - [OVMS] åº”ç”¨é€€å‡ºæ—¶å…³é—­ OVMS è¿›ç¨‹
    - [æœç´¢] å†å²æœç´¢æ˜¾ç¤ºå…³é”®è¯ä¸Šä¸‹æ–‡ç‰‡æ®µ
    - [ç»˜å›¾] DMX ç»˜å›¾æ·»åŠ æ‰©å±•å‚æ•°æ”¯æŒ
    - [ç•Œé¢] æ·»åŠ  MCP å›¾æ ‡å¹¶æ›¿æ¢é”¤å­å›¾æ ‡

    ğŸ¨ ç•Œé¢æ”¹è¿›
    - [ç¬”è®°] å°†ç¬”è®°è®¾ç½®ç§»è‡³ç¬”è®°é¡µå¼¹çª—ï¼Œå¿«é€Ÿè®¿é—®æ— éœ€ç¦»å¼€å½“å‰é¡µé¢
    - [ç½‘é¡µæœç´¢] é‡‡ç”¨ä¸¤æ å¸ƒå±€é‡æ–°è®¾è®¡è®¾ç½®ç•Œé¢ï¼Œæ·»åŠ "è®¾ä¸ºé»˜è®¤"æŒ‰é’®
    - [æ˜¾ç¤º] æ”¹è¿›é•¿å­—ä½“åç§°çš„å­—ä½“é€‰æ‹©å™¨
    - [ä¼ è¾“] LanDrop é‡å‘½åä¸º LanTransfer

    ğŸ› é—®é¢˜ä¿®å¤
    - [API] ä¿®å¤ aihubmix Anthropic API è·¯å¾„
    - [OpenRouter] æ”¯æŒ GPT-5.1/5.2 reasoning effort 'none' å¹¶æ”¹è¿›é”™è¯¯å¤„ç†
    - [æ€è€ƒ] ä¿®å¤äº¤é”™æ€è€ƒæ”¯æŒ
    - [è®°å¿†] ä¿®å¤æ£€ç´¢é—®é¢˜å¹¶å¯ç”¨æ•°æ®åº“å¤‡ä»½
    - [è®¾ç½®] æ›´æ–°é»˜è®¤åŠ©æ‰‹è®¾ç½®ç¦ç”¨æ¸©åº¦
    - [OpenAI] æ·»åŠ æŒä¹…åŒ–æœåŠ¡å™¨é…ç½®æ”¯æŒ
    - [Azure] è§„èŒƒåŒ– Azure ç«¯ç‚¹
    - [MCP] ä¼˜å…ˆæ£€æŸ¥ç³»ç»Ÿ npx/uvx å†å›é€€åˆ°å†…ç½®äºŒè¿›åˆ¶æ–‡ä»¶
    - [æç¤ºè¯] æ”¹è¿›è¯­è¨€æŒ‡ä»¤æ¸…æ™°åº¦
    - [æ¨¡å‹] GPT5.2 ç³»åˆ—æ·»åŠ åˆ° verbosity æ£€æŸ¥
    - [URL] å¢å¼º urlContext å¯¹æ”¯æŒçš„æœåŠ¡å•†å’Œæ¨¡å‹çš„éªŒè¯
    <!--LANG:END-->
