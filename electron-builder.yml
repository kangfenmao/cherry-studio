appId: com.kangfenmao.CherryStudio
productName: Cherry Studio
electronLanguages:
  - zh-CN
  - zh-TW
  - en-US
  - ja # macOS/linux/win
  - ru # macOS/linux/win
  - zh_CN # for macOS
  - zh_TW # for macOS
  - en # for macOS
  - de
directories:
  buildResources: build

protocols:
  - name: Cherry Studio
    schemes:
      - cherrystudio
files:
  - "**/*"
  - "!**/{.vscode,.yarn,.yarn-lock,.github,.cursorrules,.prettierrc}"
  - "!electron.vite.config.{js,ts,mjs,cjs}}"
  - "!.*"
  - "!components.json"
  - "!**/{.eslintignore,.eslintrc.js,.eslintrc.json,.eslintcache,root.eslint.config.js,eslint.config.js,.eslintrc.cjs,.prettierignore,.prettierrc.yaml,eslint.config.mjs,dev-app-update.yml,CHANGELOG.md,README.md,biome.jsonc}"
  - "!**/{.env,.env.*,.npmrc,pnpm-lock.yaml}"
  - "!**/{tsconfig.json,tsconfig.tsbuildinfo,tsconfig.node.json,tsconfig.web.json}"
  - "!**/{.editorconfig,.jekyll-metadata}"
  - "!src"
  - "!scripts"
  - "!local"
  - "!docs"
  - "!packages"
  - "!.swc"
  - "!.bin"
  - "!._*"
  - "!*.log"
  - "!stats.html"
  - "!*.md"
  - "!**/*.{iml,o,hprof,orig,pyc,pyo,rbc,swp,csproj,sln,xproj}"
  - "!**/*.{map,ts,tsx,jsx,less,scss,sass,css.d.ts,d.cts,d.mts,md,markdown,yaml,yml}"
  - "!**/{test,tests,__tests__,powered-test,coverage}/**"
  - "!**/{example,examples}/**"
  - "!**/*.{spec,test}.{js,jsx,ts,tsx}"
  - "!**/*.min.*.map"
  - "!**/*.d.ts"
  - "!**/dist/es6/**"
  - "!**/dist/demo/**"
  - "!**/amd/**"
  - "!**/{.DS_Store,Thumbs.db,thumbs.db,__pycache__}"
  - "!**/{LICENSE,license,LICENSE.*,*.LICENSE.txt,NOTICE.txt,README.md,readme.md,CHANGELOG.md}"
  - "!node_modules/rollup-plugin-visualizer"
  - "!node_modules/js-tiktoken"
  - "!node_modules/@tavily/core/node_modules/js-tiktoken"
  - "!node_modules/pdf-parse/lib/pdf.js/{v1.9.426,v1.10.88,v2.0.550}"
  - "!node_modules/mammoth/{mammoth.browser.js,mammoth.browser.min.js}"
  - "!node_modules/selection-hook/prebuilds/**/*" # we rebuild .node, don't use prebuilds
  - "!node_modules/selection-hook/node_modules" # we don't need what in the node_modules dir
  - "!node_modules/selection-hook/src" # we don't need source files
  - "!node_modules/tesseract.js-core/{tesseract-core.js,tesseract-core.wasm,tesseract-core.wasm.js}" # we don't need source files
  - "!node_modules/tesseract.js-core/{tesseract-core-lstm.js,tesseract-core-lstm.wasm,tesseract-core-lstm.wasm.js}" # we don't need source files
  - "!node_modules/tesseract.js-core/{tesseract-core-simd-lstm.js,tesseract-core-simd-lstm.wasm,tesseract-core-simd-lstm.wasm.js}" # we don't need source files
  - "!**/*.{h,iobj,ipdb,tlog,recipe,vcxproj,vcxproj.filters,Makefile,*.Makefile}" # filter .node build files
asarUnpack:
  - resources/**
  - "**/*.{metal,exp,lib}"
  - "node_modules/@img/sharp-libvips-*/**"

# copy from node_modules/claude-code-plugins/plugins to resources/data/claude-code-pluginso
extraResources:
  - from: "./node_modules/claude-code-plugins/plugins/"
    to: "claude-code-plugins"

win:
  executableName: Cherry Studio
  artifactName: ${productName}-${version}-${arch}-setup.${ext}
  target:
    - target: nsis
    - target: portable
  signtoolOptions:
    sign: scripts/win-sign.js
  verifyUpdateCodeSignature: false
nsis:
  artifactName: ${productName}-${version}-${arch}-setup.${ext}
  shortcutName: ${productName}
  uninstallDisplayName: ${productName}
  createDesktopShortcut: always
  allowToChangeInstallationDirectory: true
  oneClick: false
  include: build/nsis-installer.nsh
  buildUniversalInstaller: false
portable:
  artifactName: ${productName}-${version}-${arch}-portable.${ext}
  buildUniversalInstaller: false
mac:
  entitlementsInherit: build/entitlements.mac.plist
  notarize: false
  artifactName: ${productName}-${version}-${arch}.${ext}
  extendInfo:
    - NSCameraUsageDescription: Application requests access to the device's camera.
    - NSMicrophoneUsageDescription: Application requests access to the device's microphone.
    - NSDocumentsFolderUsageDescription: Application requests access to the user's Documents folder.
    - NSDownloadsFolderUsageDescription: Application requests access to the user's Downloads folder.
  target:
    - target: dmg
    - target: zip
linux:
  artifactName: ${productName}-${version}-${arch}.${ext}
  target:
    - target: AppImage
    - target: deb
    - target: rpm
  maintainer: electronjs.org
  category: Utility
  desktop:
    entry:
      StartupWMClass: CherryStudio
  mimeTypes:
    - x-scheme-handler/cherrystudio
rpm:
  # Workaround for electron build issue on rpm package:
  # https://github.com/electron/forge/issues/3594
  fpm: ["--rpm-rpmbuild-define=_build_id_links none"]
publish:
  provider: generic
  url: https://releases.cherry-ai.com
electronDownload:
  mirror: https://npmmirror.com/mirrors/electron/
beforePack: scripts/before-pack.js
afterPack: scripts/after-pack.js
afterSign: scripts/notarize.js
artifactBuildCompleted: scripts/artifact-build-completed.js
releaseInfo:
  releaseNotes: |
    <!--LANG:en-->
    What's New in v1.7.0-rc.2

    âœ¨ New Features:
    - AI Models: Added support for Gemini 3, Gemini 3 Pro with image preview, and GPT-5.1
    - Import: ChatGPT conversation import feature
    - Agent: Git Bash detection and requirement check for Windows agents
    - Search: Native language emoji search with CLDR data format
    - Provider: Endpoint type support for cherryin provider
    - Debug: Local crash mini dump file for better diagnostics

    ğŸ› Important Bug Fixes:
    - Error Handling: Improved error display in AiSdkToChunkAdapter
    - Database: Optimized DatabaseManager and fixed libsql crash issues
    - Memory: Fixed EventEmitter memory leak in useApiServer hook
    - Messages: Fixed adjacent user messages appearing when assistant message contains error only
    - Tools: Fixed missing execution state for approved tool permissions
    - File Processing: Fixed "no such file" error for non-English filenames in open-mineru
    - PDF: Fixed mineru PDF validation and 403 errors
    - Images: Fixed base64 image save issues
    - Search: Fixed URL context and web search capability
    - Models: Added verbosity parameter support for GPT-5 models
    - UI: Improved todo tool status icon visibility and colors
    - Providers: Fixed api-host for vercel ai-gateway and gitcode update config

    âš¡ Improvements:
    - SDK: Updated Google and OpenAI SDKs with new features
    - UI: Simplified knowledge base creation modal and agent creation form
    - Tools: Replaced renderToolContent function with ToolContent component
    - Architecture: Namespace tool call IDs with session ID to prevent conflicts
    - Config: AI SDK configuration refactoring

    <!--LANG:zh-CN-->
    v1.7.0-rc.2 æ–°ç‰¹æ€§

    âœ¨ æ–°åŠŸèƒ½:
    - AI æ¨¡å‹ï¼šæ–°å¢ Gemini 3ã€Gemini 3 Pro å›¾åƒé¢„è§ˆæ”¯æŒï¼Œä»¥åŠ GPT-5.1
    - å¯¼å…¥ï¼šChatGPT å¯¹è¯å¯¼å…¥åŠŸèƒ½
    - Agentï¼šWindows Agent çš„ Git Bash æ£€æµ‹å’Œè¦æ±‚æ£€æŸ¥
    - æœç´¢ï¼šæ”¯æŒæœ¬åœ°è¯­è¨€ emoji æœç´¢ï¼ˆCLDR æ•°æ®æ ¼å¼ï¼‰
    - æä¾›å•†ï¼šcherryin provider çš„ç«¯ç‚¹ç±»å‹æ”¯æŒ
    - è°ƒè¯•ï¼šå¯ç”¨æœ¬åœ°å´©æºƒ mini dump æ–‡ä»¶ï¼Œæ–¹ä¾¿è¯Šæ–­

    ğŸ› é‡è¦ä¿®å¤:
    - é”™è¯¯å¤„ç†ï¼šæ”¹è¿› AiSdkToChunkAdapter çš„é”™è¯¯æ˜¾ç¤º
    - æ•°æ®åº“ï¼šä¼˜åŒ– DatabaseManager å¹¶ä¿®å¤ libsql å´©æºƒé—®é¢˜
    - å†…å­˜ï¼šä¿®å¤ useApiServer hook ä¸­çš„ EventEmitter å†…å­˜æ³„æ¼
    - æ¶ˆæ¯ï¼šä¿®å¤å½“åŠ©æ‰‹æ¶ˆæ¯ä»…åŒ…å«é”™è¯¯æ—¶ç›¸é‚»ç”¨æˆ·æ¶ˆæ¯å‡ºç°çš„é—®é¢˜
    - å·¥å…·ï¼šä¿®å¤æ‰¹å‡†å·¥å…·æƒé™ç¼ºå°‘æ‰§è¡ŒçŠ¶æ€çš„é—®é¢˜
    - æ–‡ä»¶å¤„ç†ï¼šä¿®å¤ open-mineru å¤„ç†éè‹±æ–‡æ–‡ä»¶åæ—¶çš„"æ— æ­¤æ–‡ä»¶"é”™è¯¯
    - PDFï¼šä¿®å¤ mineru PDF éªŒè¯å’Œ 403 é”™è¯¯
    - å›¾ç‰‡ï¼šä¿®å¤ base64 å›¾ç‰‡ä¿å­˜é—®é¢˜
    - æœç´¢ï¼šä¿®å¤ URL ä¸Šä¸‹æ–‡å’Œç½‘ç»œæœç´¢åŠŸèƒ½
    - æ¨¡å‹ï¼šä¸º GPT-5 æ¨¡å‹æ·»åŠ  verbosity å‚æ•°æ”¯æŒ
    - UIï¼šæ”¹è¿› todo å·¥å…·çŠ¶æ€å›¾æ ‡å¯è§æ€§å’Œé¢œè‰²
    - æä¾›å•†ï¼šä¿®å¤ vercel ai-gateway å’Œ gitcode æ›´æ–°é…ç½®çš„ api-host

    âš¡ æ”¹è¿›:
    - SDKï¼šæ›´æ–° Google å’Œ OpenAI SDKï¼Œæ–°å¢åŠŸèƒ½å’Œä¿®å¤
    - UIï¼šç®€åŒ–çŸ¥è¯†åº“åˆ›å»ºæ¨¡æ€æ¡†å’Œ agent åˆ›å»ºè¡¨å•
    - å·¥å…·ï¼šç”¨ ToolContent ç»„ä»¶æ›¿æ¢ renderToolContent å‡½æ•°ï¼Œæå‡å¯è¯»æ€§
    - æ¶æ„ï¼šç”¨ä¼šè¯ ID å‘½åå·¥å…·è°ƒç”¨ ID ä»¥é˜²æ­¢å†²çª
    - é…ç½®ï¼šAI SDK é…ç½®é‡æ„
    <!--LANG:END-->
